
<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=40ce862f74afb522cbe4f2844a144d0fcf610b2e">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup theme-color -->
<!-- start theme color meta headers -->
<meta name="theme-color" content="#151515">
<meta name="msapplication-navbutton-color" content="#151515">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- end theme color meta headers -->


<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->


<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Redteam-TG -Secret_PDF Writeup | RedTeam-TG</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Redteam-TG -Secret_PDF Writeup" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A blog for the RedTeam-TG CTF Team." />
<meta property="og:description" content="A blog for the RedTeam-TG CTF Team." />
<link rel="canonical" href="https://redteam-tg.github.io/posts/Secret_PDF.html" />
<meta property="og:url" content="https://redteam-tg.github.io/posts/Secret_PDF.html" />
<meta property="og:site_name" content="RedTeam-TG" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Redteam-TG -Secret_PDF Writeup" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"A blog for the RedTeam-TG CTF Team.","headline":"Redteam-TG -Secret_PDF Writeup","url":"https://redteam-tg.github.io/posts/Secret_PDF.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <header>
      <div class="container">
        <a id="a-title" href="/">
          <h1>RedTeam-TG</h1>
        </a>
        <h2>A blog for the RedTeam-TG CTF Team.</h2>

        <section id="downloads">
          
          <a href="https://github.com/RedTeam-TG/RedTeam-TG.github.io" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h2 id="secret-pdf-challenge">Secret PDF Challenge</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Secret PDF

EASY BRUTEFORCE
Can you open it?

Flag : CTF_*
</code></pre></div></div>

<p>For this challenge we are given a pdf document that we have to read. Easy, just open it and read the flag?? Gift points.</p>

<p>Let’s open our file to get the flag and validate our gift points.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ┌──(kali㉿kali)-[~/CTFs/HackerlabCTF/Basic/pdf]
 └─$ evince secret.pdf  
</code></pre></div></div>

<p>Ooh We need a password to read the content of our document. I knew that they weren’t the gift-giving type. 
I know a nice tool from the john suite that can help us.</p>

<h3 id="pdf2johnpy-or-pdf2johnpl">pdf2john.py or pdf2john.pl</h3>

<p>Basically the tool extracts the hash inside the encrypted pdf that we can crack with the almighty <code class="language-plaintext highlighter-rouge">john</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──(kali㉿kali)-[~/CTFs/HackerlabCTF/Basic/pdf]
└─$ ./pdf2john secret.pdf &gt; hash 
                                                                                                                                                              
┌──(kali㉿kali)-[~/CTFs/HackerlabCTF/Basic/pdf]
└─$ cat hash 
secret.pdf:$pdf$4*4*128*-1060*1*16*15c0aee17f397540bdec4edb020a2247*32*447e5ab472a0d9557b9f8664bb73c00900000000000000000000000000000000*32*cc34bdea75a5d9ac0346d4a2adcb39ac72d8aeb6dc275e4b187fb19d3cdd2cf1:::::secret.pdf                                                                                                                             
</code></pre></div></div>
<p>it should be noted that with python3 you will have rather this.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──(kali㉿kali)-[~/CTFs/HackerlabCTF/Basic/pdf]
└─$ python pdf2john secret.pdf                                         
b'secret.pdf':b'$pdf$4*4*128*-1060*1*16*15c0aee17f397540bdec4edb020a2247*32*447e5ab472a0d9557b9f8664bb73c00900000000000000000000000000000000*32*cc34bdea75a5d9ac0346d4a2adcb39ac72d8aeb6dc275e4b187fb19d3cdd2cf1':::::b'secret.pdf'

</code></pre></div></div>
<p>which does not work as expected.</p>

<p>Let’s crack it quietly with john. And bingo!!! we have the password. The flag is waiting for us.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──(kali㉿kali)-[~/CTFs/HackerlabCTF/Basic/pdf]
└─$ john --wordlist=/usr/share/wordlists/rockyou.txt hash
Using default input encoding: UTF-8
Loaded 1 password hash (PDF [MD5 SHA2 RC4/AES 32/64])
Cost 1 (revision) is 4 for all loaded hashes
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
MyP@ssw0rd!      (secret.pdf)
1g 0:00:03:42 DONE (2022-09-02 08:39) 0.004485g/s 48484p/s 48484c/s 48484C/s MyPassword6..MyMayra1!
Use the "--show --format=PDF" options to display all of the cracked passwords reliably
Session completed

</code></pre></div></div>

<p>Oh no! at first sight the document is empty. what if we select the whole document? Oh well, there is a sequence of numbers at the bottom. It looks like something I know well.</p>

<p>A quick look at <a href="https://www.dcode.fr/identification-chiffrement">decode</a> and it tells us that there is a chance that it has something to do with ascii.</p>

<p>And voila!!!</p>

<p><code class="language-plaintext highlighter-rouge">CTF_QRC0D3T0OCT4L?!!</code></p>

<p>Done!!</p>

      </section>
    </div>
  </body>
</html>
